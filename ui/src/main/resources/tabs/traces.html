<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Traces - Source++</title>
    <link rel='stylesheet' href='../semantic.min.css'>

    <!--Dynamically set style based on dark_mode parameter-->
    <script>
        function loadCSS(filename) {
            var linkRef = document.createElement("link");
            linkRef.setAttribute("rel", "stylesheet");
            linkRef.setAttribute("type", "text/css");
            linkRef.setAttribute("href", filename);
            document.getElementsByTagName("head")[0].appendChild(linkRef);
        }

        function findGetParameter(parameterName) {
            var result = null,
                tmp = [];
            location.search
                .substr(1)
                .split("&")
                .forEach(function (item) {
                    tmp = item.split("=");
                    if (tmp[0] === parameterName) result = decodeURIComponent(tmp[1]);
                });
            return result;
        }

        var getDarkMode = findGetParameter("dark_mode");
        var darkMode = (getDarkMode) ? (getDarkMode == 'true') : false;
        if (darkMode) {
            loadCSS("css/dark_style.css");
        } else {
            loadCSS("css/style.css");
        }
    </script>
</head>
<body>
<div class="ui sidebar vertical left menu overlay visible very thin icon spp_blue"
     style="-webkit-transition-duration: 0.1s; overflow: visible !important;">
    <div class="ui accordion displaynone">
        <a class="item openbtn" style="background-color: white; height: 45px !important;">Close menu</a>
        <a id="sidebar_overview_link" class="item inactive_tab" href="overview.html">Dashboard</a>

        <div class="title item active_tab">
            <i class="dropdown icon"></i> Traces
        </div>
        <div class="content">
            <a id="sidebar_traces_link_latest" class="item sidebar_sub_text_color" href="traces.html">Latest</a>
            <a id="sidebar_traces_link_slowest" class="item sidebar_sub_text_color" href="traces.html">Slowest</a>
        </div>
        <a id="sidebar_configuration_link" class="item inactive_tab" href="configuration.html">Configuration</a>
    </div>
    <div class="ui dropdown item openbtn" style="color: white">
        <i class="icon demo-icon content"></i>
    </div>
    <a id="overview_link" class="ui item hide_on_toggle" href="overview.html">
        <i class="icon demo-icon dashboard inactive_tab"></i>
    </a>
    <div class="ui dropdown item active_tab">
        <z class="displaynone">Traces</z>
        <i class="icon demo-icon code"></i>

        <div class="menu background_color">
            <a id="traces_link_latest" class="item" href="traces.html">
                <span class="menu_tooltip_text">Latest</span>
            </a>
            <a id="traces_link_slowest" class="item" href="traces.html">
                <span class="menu_tooltip_text">Slowest</span>
            </a>
        </div>
    </div>
    <a id="configuration_link" class="ui item hide_on_toggle" href="configuration.html">
        <i class="icon configure inactive_tab"></i>
    </a>
</div>
<div class="pusher background_color">
    <div class="ui menu borderless marginlefting background_color"
         style="border-radius: 0 !important; border: 0; -webkit-transition-duration: 0.1s; height: 45px; margin-bottom: 0">
        <a id="latest_traces_header" onclick="clickedBackToTraces()" class="ui item dropdown active_sub_tab">
            <span id="latest_traces_header_text">Latest Traces</span>
            <div id="latest_traces_menu" class="menu">
                <div class="ui input item">
                    <i class="play icon spp_blue_color"></i>
                    <input id="traces_start_field" type="text" style="width: 210px" readonly>
                </div>
                <div class="ui input item">
                    <i class="stop icon spp_red_color"></i>
                    <input id="traces_stop_field" type="text" style="width: 210px" readonly>
                </div>
                <div class="divider"></div>
                <div class="ui input item" style="text-align: center">
                    <label id="traces_total_label">Total: 0</label>
                </div>
            </div>
        </a>
        <a id="trace_stack_header" onclick="clickedBackToTraceStack()" class="ui item dropdown"
           style="visibility: hidden">
            <span id="trace_stack_header_text">Trace Stack</span>
            <div id="trace_stack_menu" class="menu">
                <div class="ui input item">
                    <i class="crosshairs icon"></i>
                    <input id="trace_id_field" type="text" style="width: 210px" readonly>
                </div>
                <div class="ui input item">
                    <i class="clock outline icon"></i>
                    <input id="time_occurred_field" type="text" style="width: 210px" readonly>
                </div>
            </div>
        </a>
        <a id="span_info_header" class="ui item dropdown" style="visibility: hidden">
            <span id="span_info_header_text">Span Info</span>
        </a>
        <div class="right menu" style="height: 45px; line-height: 45px; align-content:center;">
            <a id="current_page_external" href="#" onclick="clickedViewAsExternalPortal()">
                <i class="external link icon spp_red_color" style="font-size: 20px; margin-top: -2px"></i>
            </a>
        </div>
    </div>
    <div class="wide column marginlefting">
        <table style="margin-top: 0" id="top_trace_table"
               class="ui celled striped table unstackable secondary_background_color">
            <thead>
            <tr>
                <th style="padding-top: 5px; padding-bottom: 5px" class="secondary_background_color">Operation</th>
                <th style="padding-top: 5px; padding-bottom: 5px; text-align: center" class="secondary_background_color">Occurred</th>
                <th style="padding-top: 5px; padding-bottom: 5px; text-align: center" class="secondary_background_color">Exec</th>
                <th style="padding-top: 5px; padding-bottom: 5px; text-align: center" class="secondary_background_color">Status</th>
            </tr>
            </thead>
            <tbody id="trace_table">
            </tbody>
        </table>
        <table id="trace_stack_table" style="visibility: hidden; margin-top: 0"
               class="ui celled striped table unstackable trace_stack_table">
            <thead class="secondary_background_color">
            <tr>
                <th style="padding-top: 5px; padding-bottom: 5px" class="secondary_background_color">Operation</th>
                <th style="padding-top: 5px; padding-bottom: 5px; text-align: center" class="secondary_background_color">Exec</th>
                <th style="padding-top: 5px; padding-bottom: 5px; text-align: center" class="secondary_background_color">Exec (%)</th>
                <th style="padding-top: 5px; padding-bottom: 5px; text-align: center" class="secondary_background_color">Status</th>
            </tr>
            </thead>
            <tbody id="stack_table" class="stack_table_background">
            </tbody>
        </table>
        <div id="span_info_panel" style="visibility: hidden">
            <div class="ui segments">
                <div class="ui segment span_segment_background">
                    <p>
                        Start time: <span id="span_info_start_time"></span>
                        (<span id="span_info_start_trace_time" class="trace_time"></span>)
                    </p>
                    <p>
                        Start time: <span id="span_info_end_time"></span>
                        (<span id="span_info_end_trace_time" class="trace_time"></span>)
                    </p>
                </div>
                <div id="span_tag_div" class="ui segment displaynone" style="padding: 0">
                    <table id="span_tag_table" class="ui celled striped table unstackable">
                        <thead>
                        <tr>
                            <th>Tag</th>
                            <th>Value</th>
                        </tr>
                        </thead>
                        <tbody id="tag_table">
                        </tbody>
                    </table>
                </div>
                <div id="span_log_div" class="ui segment displaynone" style="padding: 0">
                    <table id="log_tag_table" class="ui celled striped table unstackable">
                        <thead>
                        <tr>
                            <th>Trace Logs</th>
                        </tr>
                        </thead>
                        <tbody id="log_table">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
<script src='../jquery-3.1.1.min.js'></script>
<script src='../semantic.min.js'></script>
<script>
    $(document).ready(function () {
        $('.ui.dropdown').dropdown();
        $('#latest_traces_header').dropdown({on: null});
        $('#trace_stack_header').dropdown({on: 'hover'});

        $('.ui.sidebar').sidebar('setting', 'transition', 'overlay');
    });
    $(".openbtn").on("click", function () {
        $(".ui.sidebar").toggleClass("very thin icon");
        $(".asd").toggleClass("marginlefting");
        $(".sidebar z").toggleClass("displaynone");
        $(".ui.accordion").toggleClass("displaynone");
        $(".ui.dropdown.item").toggleClass("displaynone");
        $(".hide_on_toggle").toggleClass("displaynone");
        $(".pusher").toggleClass("dimmed");

        $(".logo").find('img').toggle();

    });
    $('.ui.accordion').accordion({
        selector: {}
    });
</script>
<script src="../moment.min.js"></script>
<script src="../sockjs.min.js"></script>
<script src='../vertx-eventbus.min.js'></script>
<script src='../source_eventbus_bridge.js'></script>
<script src='js/traces.js'></script>
<script src='js/views/traces_view.js'></script>
</body>
</html>